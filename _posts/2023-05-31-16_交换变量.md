# 十六、交换变量

## 1. 概念定义

将两个变量当作两个盒子，数据就是盒子里面的东西，交换变量就是交换它们之间的数据，就是将两个盒子中的东西互换。

如以下代码

```java
int a = 1;
int b = 2;
```

a，b 都是盒子，1，2 分别是盒子中的东西，交换后，a 里面是 2，b 里面是 1。

## 2. 具体实现

### 1）第三方变量

联系我们的日常生活，要想交换两个盒子里的东西，一般有三个步骤：

+ 先将 a 盒子里的东西拿出来放好，可以放在一个临时的 c 盒子中，
+ 再将 b 盒子里的东西拿出来放进 a 盒子，
+ 再将 c 盒子中的东西放进 b 盒子

这个 c 盒子就是第三方变量，所以用代码实现如下：

C语言代码

```c
void swap(int* a, int* b) {  // (1)
    int c = *a;  // (2)
    *a = *b;
    *b = c;
}
```

（1）：这里使用地址传递的方式，真正交换 a，b 的值

（2）：c 就是那个临时变量

### 2）加减法

这个方法很巧妙啊。直接通过代码来理解。

C语言代码

```c
void swap(int* a, int* b) {
    *a = *a + *b;  //（1）
    *b = *a - *b;  //（2）
    *a = *a - *b;  //（3）
}
```

（1）：此时的 a 就是 a+b

（2）：此时的 b 就是 (a+b)-b，b 的值就变成了 a

（3）：此时的 a 就是 (a+b)-a，a 的值就变成了 b

### 3）位运算

这个方法更加巧妙啊。

该方法会用到位运算符异或（\^），它的运算规则是：==相同为 0，相异为 1，0 异或任何数都为任何数本身==。

还是直接通过代码理解。

C语言代码

```c
void swap(int* a, int* b) {
    *a ^= *b;  // (1)
    *b ^= *a;  // (2)
    *a ^= *b;  // (3)
}
```

（1）：此时的 a 是 a \^ b

（2）：此时的 b 是 b \^ (a \^ b)，b \^ b = 0，0 \^ a = a，b 的值就变成了 a

（3）：此时的 a 是 (a \^ b) ^ a，a \^ a = 0，0 \^ b = b，a 的值就变成了 b

## 3. 题目练习

| 序号 | 题目链接                                                     | 备注 |
| ---- | ------------------------------------------------------------ | ---- |
| 1    | [交换数字](https://leetcode.cn/problems/swap-numbers-lcci/description/) |      |
| 2    | [配对交换](https://leetcode.cn/problems/exchange-lcci/description/) |      |

## 4. 题解报告

  [配对交换](https://leetcode.cn/problems/exchange-lcci/description/)

**题目描述**

> 配对交换。编写程序，交换某个整数的奇数位和偶数位，尽量使用较少的指令（也就是说，位0与位1交换，位2与位3交换，以此类推）。

**解题思路1**

【暴力】

使用数组保存下指定数的二进制位，然后两位两位进行交换，最后再转为十进制数即可。

**Java代码**

```java
class Solution {
    public int exchangeBits(int num) {
        int[] b = new int[32];
        int top = 0;
        for (int i = 0; i < 32; i++) {
            b[i] = num & 1;
            num >>= 1;
        }
        for (int i = 0, j = 1; j < 32; i+=2, j+=2) {
            int t = b[i];
            b[i] = b[j];
            b[j] = t;
        }
        int t = 1;
        int ans = 0;
        for (int i = 0; i < 32; i++) {
            ans += b[i] * t;
            t *= 2;
        }
        return ans;
    }
}
```

**解题思路2**

【牛逼位运算】

二进位上都是 0 和 1，我们可以把数的奇数位置和偶数位置上的 0 或 1 分别保存下来，然后奇数位置的数往左移动一位，偶数位置的数往右移动一位，最后两部分执行或操作即可。

+ 保留偶数位：与 0xaaaaaaaa（偶数位全为 1）进行 与 操作
+ 保留奇数位：与 0x55555555（奇数位全为 1）进行 与 操作

为什么执行或操作呢，因为或操作的规则是：==有1为1，全0为0==。

比如：14 = 0b1110，保留它的偶数位：1010，右移一位为 0101，奇数位：0100，左移一位为 1000，两部分执行或操作：0101 | 1000 = 1101，正是 1110 相邻两位交换后的结果。

**Java代码**

```java
class Solution {
    public int exchangeBits(int num) {
        return (num & 0xaaaaaaaa) >> 1 | (num & 0x55555555) << 1; 
    }
}
```

---

#